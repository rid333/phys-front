import type { PageLoad } from "./$types";

let API_URL = import.meta.env.VITE_API_URL;

type ActivityItem = {
    id: number;
    title: string;
    image: {
        sizes: {
            thumbnail: {
                url: string;
            }
        }
    };
    date: string;
    time: string;
    location: string;
}

export const load: PageLoad = async ( { fetch } ) => {
    const res = await fetch(`${API_URL}/api/activities`);
    const items = await res.json();

    const activities: {
        id: number;
        judul: string;
        thumbnail: string;
        date: string;
        time: string;
        location: string;
    } [] = items.docs.map((activityItem: ActivityItem) => ({
        id: activityItem.id,
        judul: activityItem.title,
        thumbnail: `${API_URL}${activityItem.image.sizes.thumbnail.url}`,
        date: activityItem.date,
        time: activityItem.time,
        location: activityItem.location
    }))

    return { activities };
}